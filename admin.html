<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ø±ÙƒØ² Ø±Ø³Ø§Ø¦Ù„ Ø³Ø¨ÙŠØ³ØªÙˆÙ†</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #0a114d; color: white; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { background: #182694; padding: 30px; border-radius: 15px; width: 400px; box-shadow: 0 0 30px rgba(0,0,0,0.7); border: 2px solid #ffd700; text-align: center; }
        h2 { color: #ffd700; text-shadow: 2px 2px 4px #000; }
        input, button, textarea { width: 100%; margin-top: 10px; padding: 12px; border-radius: 8px; border: none; box-sizing: border-box; font-size: 16px; }
        input, textarea { background: #fff; color: #333; }
        button { background: #ffd700; color: #182694; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: #fff; }
        .admin-only { background: #ff4d4d !important; color: white !important; margin-top: 20px; display: none; }
        .hidden { display: none; }
        #status { margin-top: 10px; color: #3dfc4a; font-size: 14px; }
        .toggle-link { font-size: 12px; cursor: pointer; color: #ffd700; text-decoration: underline; display: block; margin-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <h2>Ù‚Ù†Ø§Ø© Ø´Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ğŸš€</h2>
    
    <div id="auth-section">
        <input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
        <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button id="auth-btn" onclick="handleAuth()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        <span class="toggle-link" onclick="toggleAuthMode()" id="toggle-text">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</span>
    </div>

    <div id="msg-section" class="hidden">
        <p id="user-welcome"></p>
        <input type="text" id="nickname" placeholder="Ø§Ø³Ù…Ùƒ ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· (Ù…Ø«Ù„Ø§Ù‹: ÙƒÙˆÙ†Ø§Ù†)">
        <textarea id="msg" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."></textarea>
        <button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ OBS</button>
        
        <button id="clear-btn" class="admin-only" onclick="clearMessages()">Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (Ù„Ù„Ù…Ø´Ø±Ù ÙÙ‚Ø·)</button>
        
        <button onclick="logout()" style="background: transparent; color: #ccc; font-size: 12px; border: 1px solid #555; margin-top: 20px;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>

    <p id="status"></p>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyAtO7mz0ZptyJKCBo1ouV420ej5bWC5VYY",
        databaseURL: "https://spacetoonold-aaac4-default-rtdb.firebaseio.com", 
        projectId: "spacetoonold-aaac4",
        storageBucket: "spacetoonold-aaac4.firebasestorage.app",
        appId: "1:511855750136:web:d353fa9309ac5e54a9040d"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    let isLoginMode = true;

    function toggleAuthMode() {
        isLoginMode = !isLoginMode;
        document.getElementById('auth-btn').innerText = isLoginMode ? "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„" : "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯";
        document.getElementById('toggle-text').innerText = isLoginMode ? "Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†" : "Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ Ø§Ø¯Ø®Ù„ Ù‡Ù†Ø§";
    }

    async function handleAuth() {
        const email = document.getElementById('email').value;
        const pass = document.getElementById('password').value;
        try {
            if (isLoginMode) {
                await auth.signInWithEmailAndPassword(email, pass);
            } else {
                await auth.createUserWithEmailAndPassword(email, pass);
            }
        } catch (error) {
            alert(error.message);
        }
    }

    auth.onAuthStateChanged(user => {
        if (user) {
            document.getElementById('auth-section').classList.add('hidden');
            document.getElementById('msg-section').classList.remove('hidden');
            document.getElementById('user-welcome').innerText = "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ: " + user.email;
            
            // Show Clear button ONLY for Admin (Ayman)
            if (user.email === "aymanbouraaman@gmail.com") { // CHANGE THIS TO YOUR EMAIL
                document.getElementById('clear-btn').style.display = "block";
            }
        } else {
            document.getElementById('auth-section').classList.remove('hidden');
            document.getElementById('msg-section').classList.add('hidden');
        }
    });

    function sendMessage() {
        const nick = document.getElementById('nickname').value || "Ø¹Ø¶Ùˆ Ø³Ø¨ÙŠØ³ØªÙˆÙ†ÙŠ";
        const msgText = document.getElementById('msg').value;

        if(!msgText) return alert("Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹!");

        db.ref('latestMessage').set({
            username: nick,
            text: msgText,
            timestamp: Date.now()
        }).then(() => {
            document.getElementById('status').innerText = "ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­! ğŸš€";
            document.getElementById('msg').value = "";
            setTimeout(() => { document.getElementById('status').innerText = ""; }, 3000);
        });
    }

    function clearMessages() {
        if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø§Ù„Ø´Ø±ÙŠØ· ÙØ¹Ù„Ø§Ù‹ØŸ")) {
            db.ref('latestMessage').remove();
            alert("ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø´Ø±ÙŠØ·");
        }
    }

    function logout() { auth.signOut(); }
</script>
</body>
</html>
